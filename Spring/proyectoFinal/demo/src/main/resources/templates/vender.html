<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" type="text/css" th:href="@{/vender.css}" />
    <title th:text="#{title.vender}">Vender Skins - CS Skin Market</title>
</head>
<body>
<div class="language-switcher" style="text-align:right; margin:10px;">
    <a th:href="@{/vender(lang='es')}" style="margin-right:5px;">ðŸ‡ªðŸ‡¸ EspaÃ±ol</a>
    <a th:href="@{/vender(lang='en')}">ðŸ‡¬ðŸ‡§ English</a>
</div>
<div class="vender-container">
    <h1 th:text="#{vender.titulo}">Vender Skins</h1>
    <form th:action="@{/venderSkin}" method="post">

    <!-- CategorÃ­a -->
    <label for="categoria" th:text="#{vender.categoria}">CategorÃ­a:</label>
    <select id="categoria" name="categoriaId" required>
        <option value="" th:text="#{vender.seleccioneCategoria}">Seleccione categorÃ­a</option>
        <option th:each="c : ${categorias}"
                th:value="${c.id}"
                th:text="${c.nombre}">
        </option>
    </select>

    <!-- Tipo -->
    <label for="tipo" th:text="#{vender.tipo}">Tipo:</label>
    <select id="tipo" name="tipoId" required>
        <option value="" th:text="#{vender.seleccioneTipo}">Seleccione tipo</option>
    </select>

    <!-- Skin -->
    <label for="skin" th:text="#{vender.skin}">Nombre de la skin:</label>
    <input type="text" id="skin" name="skinNombre" th:placeholder="#{vender.skinPlaceholder}" placeholder="Escribe el nombre de la skin" required>

    <label for="precio" th:text="#{vender.precio}">Precio de venta (â‚¬):</label>
    <input type="number" id="precio" name="precio" min="0" required>

    <label for="imagen" th:text="#{vender.imagen}">URL de la imagen:</label>
    <input type="text" id="imagen" name="imagenUrl" th:placeholder="#{vender.imagenPlaceholder}" placeholder="https://..." required>

    <button type="submit" th:text="#{vender.boton}">Enviar para venta</button>
    <div class="menu-back">
        <a th:href="@{/menu}">
            <button type="button" class="menu-back-btn" th:text="#{button.volverMenu}">Volver al menÃº</button>
        </a>
    </div>
</form>
</div>

<script>
    document.getElementById("categoria").addEventListener("change", function() {
        let categoriaId = this.value;
        if (!categoriaId) return;

        fetch("/api/categorias/" + categoriaId + "/tipos")
            .then(response => response.json())
            .then(data => {
                let tipoSelect = document.getElementById("tipo");
                tipoSelect.innerHTML = '<option value="">Seleccione tipo</option>';
                data.forEach(tipo => {
                    tipoSelect.innerHTML += `<option value="${tipo.id}">${tipo.nombre}</option>`;
                });

                document.getElementById("skin").innerHTML = '<option value="">Seleccione skin</option>';
            });
    });
</script>
</body>
</html>